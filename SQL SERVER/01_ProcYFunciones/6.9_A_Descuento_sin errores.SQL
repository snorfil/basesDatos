--6.9 Dado un cliente , si se  le  ha vendido más de 1000 € poner 10 en descuento , 
--sino si es mayor de 100 € poner 5 %       y sino 0.

CREATE PROCEDURE CLIENTE_DESCUENTO
@IDCLI VARCHAR(5)
AS
DECLARE @IMPORTE INT
SELECT  @IMPORTE= SUM(PRECIOUNIDAD*CANTIDAD)
    FROM dbo.PEDIDOSDETA
	join VENTA.pedidoscabe
    on pedidoscabe.idpedido=pedidosdeta.idpedido 
    WHERE idcliente=@IDCLI
IF @IMPORTE > 1000
	UPDATE VENTA.CLIENTES SET DESCUENTO=10 WHERE idcliente=@IDCLI
ELSE IF @IMPORTE >100
	UPDATE VENTA.CLIENTES SET DESCUENTO=5 WHERE idcliente=@IDCLI
ELSE
	UPDATE VENTA.CLIENTES SET DESCUENTO=0 WHERE idcliente=@IDCLI

GO

EXEC CLIENTE_DESCUENTO 'NCBCK'
SELECT * FROM VENTA.clientes